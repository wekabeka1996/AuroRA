[pytest]
addopts = -q
testpaths = tests
asyncio_default_fixture_loop_scope = function

# Markers taxonomy
markers =
    legacy: покриває застарілий/архівний код
    exchange_decimal: Decimal boundary/кодеки
    router_percent_price: STOP/TP workingType/PERCENT_PRICE
    idempotency_persist: персистентний стор
    ops: технічні ендпоїнти /ops/*
    system_validation: e2e канарейка

# Strict legacy import guard: any accidental legacy import fails
filterwarnings =
    error::DeprecationWarning:core\.execution\.(router|shadow_broker|.*_v1|.*_backup|enhanced_router)
    ignore::PendingDeprecationWarning
    ignore::pytest.PytestUnraisableExceptionWarning
    ignore:.*on_event.*is deprecated.*:DeprecationWarning
    ignore:.*@app\.on_event.*:DeprecationWarning
