# **Посібник з запуску Aurora (auroractl.py)**

## **Огляд**
Aurora CLI (`auroractl.py`) - це уніфікований інструмент командного рядка для управління Aurora API, тестування та моніторингу.

## **Структура команд**
```bash
python tools/auroractl.py [опції] <команда> [аргументи команди]
```

## **Основні команди**

### **1. Запуск API сервера**
```bash
# Базовий запуск на порту 8000
cd /c/Users/user/Music/Aurora
python tools/auroractl.py start-api

# Запуск на конкретному порту
python tools/auroractl.py start-api --port 8080

# Запуск у фоні (без очікування health check)
python tools/auroractl.py start-api --background
```

### **2. Зупинка API сервера**
```bash
cd /c/Users/user/Music/Aurora
python tools/auroractl.py stop-api
```

### **3. Перевірка здоров'я API**
```bash
cd /c/Users/user/Music/Aurora
python tools/auroractl.py health

# Перевірка конкретного порту
python tools/auroractl.py health --port 8080

# Перевірка з токеном (для захищених ендпоінтів)
python tools/auroractl.py health --ops-token ваш_токен
```

### **4. Повний цикл тестування (one-click)**
```bash
cd /c/Users/user/Music/Aurora

# Тестнет режим (за замовчуванням)
python tools/auroractl.py one-click

# З конкретною тривалістю
python tools/auroractl.py one-click --minutes 30

# Live режим
python tools/auroractl.py one-click --mode live

# З runner у тестнеті
python tools/auroractl.py one-click --runner-in-testnet

# З кастомною конфігурацією runner
python tools/auroractl.py one-click --runner-config profiles/sol_soon_base.yaml
```

### **5. Перевірка гаманця**
```bash
cd /c/Users/user/Music/Aurora
python tools/auroractl.py wallet-check
```

### **6. Агрегація метрик**
```bash
cd /c/Users/user/Music/Aurora

# За останню годину
python tools/auroractl.py metrics

# З конкретним вікном (у секундах)
python tools/auroractl.py metrics --window-sec 3600

# З арифметичним виразом
python tools/auroractl.py metrics --window-sec "30*60"
```

### **7. Конфігурація**
```bash
cd /c/Users/user/Music/Aurora

# Встановити конфіг
python tools/auroractl.py config-use --name master_config_v2

# Валідація конфіга
python tools/auroractl.py config-validate
```

### **8. Інші корисні команди**
```bash
cd /c/Users/user/Music/Aurora

# Димовий тест Binance
python tools/auroractl.py smoke

# Тільки публічні ендпоінти
python tools/auroractl.py smoke --public-only

# Короткий тестнет цикл
python tools/auroractl.py testnet --minutes 5

# Canary тест
python tools/auroractl.py canary --minutes 60

# Відключення (disarm)
python tools/auroractl.py disarm --ops-token ваш_токен

# Cooloff період
python tools/auroractl.py cooloff --sec 120 --ops-token ваш_токен
```

## **Важливі опції**
- `--dotenv` / `--no-dotenv` - завантаження .env файлу
- `--help` - допомога по команді
- `--ops-token` - токен для захищених операцій

## **Приклад повного робочого циклу**
```bash
cd /c/Users/user/Music/Aurora

# 1. Перевірка гаманця
python tools/auroractl.py wallet-check

# 2. Запуск API
python tools/auroractl.py start-api

# 3. Перевірка здоров'я
python tools/auroractl.py health

# 4. Запуск бота в окремому терміналі
python -m skalp_bot.runner.run_live_aurora --config profiles/sol_soon_base.yaml

# 5. Агрегація метрик (в іншому терміналі)
python tools/auroractl.py metrics

# 6. Зупинка API
python tools/auroractl.py stop-api
```

## **Альтернативний спосіб: one-click тестування**
```bash
cd /c/Users/user/Music/Aurora

# Повний цикл тестування (API + бот + метрики)
python tools/auroractl.py one-click --minutes 15 --runner-in-testnet
```

## **Доступні команди (повний список)**
- `start-api` - Запуск FastAPI з uvicorn
- `config-use` - Встановлення конфігурації в .env
- `config-validate` - Валідація YAML конфігурації
- `stop-api` - Зупинка uvicorn/api процесу
- `health` - HTTP перевірка здоров'я
- `canary` - Запуск canary тесту
- `smoke` - Швидкий димовий тест Binance
- `testnet` - Короткий тестнет цикл
- `wallet-check` - Перевірка ключів/балансів біржі
- `metrics` - Агрегація events.jsonl у зведення
- `disarm` - POST до /aurora/disarm
- `cooloff` - POST до /ops/cooloff/{sec}
- `one-click` - Повний цикл: wallet-check → start API → canary → metrics → stop API

## **Примітки**
- Всі команди виконуються з директорії проекту `/c/Users/user/Music/Aurora`
- Скрипт автоматично завантажує змінні середовища з `.env` файлу
- Для отримання детальної допомоги по будь-якій команді використовуйте `--help`

### **9. Запуск бота (Scalper Bot)**

#### **Основний спосіб (рекомендовано):**
```bash
cd /c/Users/user/Music/Aurora

# Через модуль з конфігом
python -m skalp_bot.runner.run_live_aurora --config profiles/sol_soon_base.yaml

# Через модуль без конфіга (використає змінні середовища)
python -m skalp_bot.runner.run_live_aurora

# Через прямий скрипт
python skalp_bot/scripts/run_live_aurora.py profiles/sol_soon_base.yaml
```

#### **Важливі змінні середовища для бота:**
```bash
# Режим роботи
export AURORA_MODE=live          # або testnet
export DRY_RUN=true              # або false для реальних торгів

# API налаштування
export AURORA_BASE_URL=http://127.0.0.1:8000
export AURORA_HTTP_TIMEOUT_MS=120

# Біржові ключі (для live режиму)
export BINANCE_API_KEY=ваш_ключ
export BINANCE_API_SECRET=ваш_секрет

# Параметри торгівлі
export AURORA_TP_PCT=0.00001     # Take profit (1 bp)
export AURORA_MAX_TICKS=1000     # Максимальна кількість ітерацій
```

#### **Різниця між файлами запуску бота:**
- **`skalp_bot/runner/run_live_aurora.py`** - **Основний файл** з усією логікою бота
  - Містить класи, функції та основний цикл торгівлі
  - Приймає аргументи `--config` та `--base-url`
  - Запускається як: `python -m skalp_bot.runner.run_live_aurora`

- **`skalp_bot/scripts/run_live_aurora.py`** - **Проста обгортка**
  - Просто імпортує `main` з основного файлу
  - Приймає тільки шлях до конфіга як аргумент
  - Запускається як: `python skalp_bot/scripts/run_live_aurora.py config.yaml`

## **Типові помилки та їх вирішення**

### **API не запускається:**
```bash
# Перевірити, чи порт зайнятий
netstat -ano | findstr :8000

# Звільнити порт (Windows)
taskkill /PID <PID> /F

# Або змінити порт
python tools/auroractl.py start-api --port 8080
```

### **Бот не може підключитися до API:**
```bash
# Перевірити, чи API запущено
python tools/auroractl.py health

# Змінити URL API для бота
export AURORA_BASE_URL=http://127.0.0.1:8080
python -m skalp_bot.runner.run_live_aurora
```

### **Помилки авторизації біржі:**
```bash
# Перевірити ключі
python tools/auroractl.py wallet-check

# Для тестнету встановити
export EXCHANGE_TESTNET=true
```

### **Файл конфігурації не знайдено:**
```bash
# Перевірити наявність файлу
ls -la profiles/sol_soon_base.yaml

# Запустити без конфіга (використає змінні середовища)
python -m skalp_bot.runner.run_live_aurora
```

---
*Згенеровано автоматично для Aurora CLI*