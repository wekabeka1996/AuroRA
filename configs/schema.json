{
  "$id": "aurora.schema/v1",
  "version": "1.0.0",
  "hotReloadWhitelist": [
    "risk.cvar.limit",
    "risk.cvar.alpha",
    "execution.sla.max_latency_ms",
    "features.scaling",
    "governance.alpha0",
    "governance.delta",
    "governance.spend_step",
    "governance.policy"
  ],
  "schema": {
    "type": "object",
    "additionalProperties": true,
    "required": ["risk", "execution"],
    "properties": {
      "risk": {
        "type": "object",
        "additionalProperties": true,
        "required": ["cvar"],
        "properties": {
          "limits": {
            "type": "object",
            "additionalProperties": true,
            "properties": {
              "dd_day_bps": { "type": "number", "minimum": 0, "default": 300.0 },
              "position_usd": { "type": "number", "minimum": 0, "default": 25000.0 },
              "order_min_usd": { "type": "number", "minimum": 0, "default": 10.0 },
              "order_max_usd": { "type": "number", "minimum": 0, "default": 5000.0 },
              "cvar_usd": { "type": "number", "minimum": 0, "default": 150.0 },
              "evt_quantile": { "type": "number", "minimum": 0.9, "maximum": 0.9999, "default": 0.999 },
              "evt_max_loss_usd": { "type": "number", "minimum": 0, "default": 400.0 }
            }
          },
          "cvar": {
            "type": "object",
            "additionalProperties": true,
            "properties": {
              "limit": { "type": "number", "minimum": 0, "maximum": 1, "default": 0.02 },
              "alpha": { "type": "number", "minimum": 0.8, "maximum": 0.999, "default": 0.95 },
              "method": { "type": "string", "enum": ["historical", "gaussian", "cornish-fisher", "student-t", "pot-gpd"], "default": "pot-gpd" },
              "confidence": { "type": "number", "minimum": 0.5, "maximum": 0.9999, "default": 0.975 },
              "lookback": { "type": "integer", "minimum": 30, "maximum": 100000, "default": 5000 }
            },
            "required": ["limit"]
          },
          "evt_pot": {
            "type": "object",
            "additionalProperties": true,
            "properties": {
              "u_percentile": { "type": "number", "minimum": 0.8, "maximum": 0.99, "default": 0.95 },
              "bootstrap": { "type": "integer", "minimum": 100, "maximum": 10000, "default": 500 }
            }
          }
        }
      },
      "execution": {
        "type": "object",
        "additionalProperties": true,
        "required": ["sla"],
        "properties": {
          "sla": {
            "type": "object",
            "additionalProperties": true,
            "properties": {
              "max_latency_ms": { "type": "integer", "minimum": 0, "default": 25 },
              "kappa_bps_per_ms": { "type": "number", "minimum": 0, "default": 0.05 },
              "target_fill_prob": { "type": "number", "minimum": 0, "maximum": 1, "default": 0.6 },
              "edge_floor_bps": { "type": "number", "minimum": 0, "default": 0.0 }
            },
            "required": ["max_latency_ms"]
          },
          "router": {
            "type": "object",
            "additionalProperties": true,
            "properties": {
              "mode_default": { "type": "string", "enum": ["maker", "taker", "hybrid"], "default": "hybrid" }
            }
          },
          "exchange": { "type": "object", "additionalProperties": true }
        }
      },
      "governance": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "alpha0": {"type": "number", "minimum": 1e-6, "maximum": 1.0, "default": 0.05},
          "delta": {"type": "number", "minimum": 0.0, "maximum": 10.0, "default": 0.1},
          "spend_step": {"type": "number", "minimum": 1e-9, "maximum": 0.1, "default": 0.001},
          "policy": {"type": "string", "enum": ["pocock","obf","bh_fdr"], "default": "pocock"}
        }
      },
      "features": {
        "type": "object",
        "additionalProperties": true
      },
      "signal": { "type": "object", "additionalProperties": true },
      "calibration": { "type": "object", "additionalProperties": true },
      "regime": { "type": "object", "additionalProperties": true },
      "tca": { "type": "object", "additionalProperties": true },
      "sizing": { "type": "object", "additionalProperties": true },
      "profile": { "type": "object", "additionalProperties": true },
      "universe": { "type": "object", "additionalProperties": true },
      "xai": { "type": "object", "additionalProperties": true },
      "leadlag": {
        "type": "object",
        "properties": {
          "grid": { "type": "array", "items": { "type": "number" }, "minItems": 1 },
          "max_tau": { "type": "number", "minimum": 0 },
          "method": { "type": "string", "enum": ["coherence", "xcorr", "hawkes"] }
        }
      },
      "replay": {
        "type": "object",
        "properties": {
          "chunk_minutes": { "type": "integer", "minimum": 1 }
        }
      },
      "timescale": {
        "type": "object",
        "properties": {
          "ts_unit": { "type": "string", "enum": ["ns", "ms", "s"] }
        },
        "required": ["ts_unit"]
      },
      "hotreload": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "whitelist": { "type": "array", "items": { "type": "string" } }
        }
      },
      "logger": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "jsonl": {
            "type": "object",
            "additionalProperties": true,
            "properties": {
              "max_mb": { "type": "number", "minimum": 1, "default": 100 },
              "compress": { "type": "boolean", "default": true },
              "retention_files": { "anyOf": [{ "type": "integer" }, { "type": "null" }], "minimum": 0 }
            }
          }
        }
      },
      "order_sink": {
        "type": "object",
        "properties": {
          "mode": { "type": "string", "enum": ["sim_local", "none"] },
          "sim_local": {
            "type": "object",
            "properties": {
              "latency_ms": { "type": "number", "minimum": 0 },
              "ttl_ms": { "type": "integer", "minimum": 1 },
              "maker_queue_model": { "type": "string", "enum": ["fifo", "pro_rata", "hybrid"] },
              "taker_slip_model": { "type": "string", "enum": ["none", "l1", "lN", "surrogate"] }
            },
            "required": ["latency_ms", "ttl_ms"],
            "additionalProperties": false
          }
        },
        "required": ["mode"],
        "additionalProperties": false
      }
    }
  }
}
